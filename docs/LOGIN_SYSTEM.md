# ç™»å½•ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

GoQGo Webåº”ç”¨ç°åœ¨æ”¯æŒåŸºäºTokençš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼Œç¡®ä¿åªæœ‰æˆæƒç”¨æˆ·æ‰èƒ½è®¿é—®ç³»ç»Ÿèµ„æºã€‚

## ğŸ” è®¤è¯æ–¹å¼

### 1. Tokenç™»å½•ï¼ˆå·²å®ç°ï¼‰
- **è¾“å…¥æ–¹å¼**: ç”¨æˆ·è¾“å…¥è®¿é—®ä»¤ç‰Œ
- **éªŒè¯é€»è¾‘**: å‰ç«¯éªŒè¯tokenæ ¼å¼ï¼Œåå°è§£æç”¨æˆ·ä¿¡æ¯
- **å­˜å‚¨æ–¹å¼**: localStorageæŒä¹…åŒ–å­˜å‚¨
- **æœ‰æ•ˆæœŸ**: 24å°æ—¶ï¼ˆå¯é…ç½®ï¼‰

### 2. ADç™»å½•ï¼ˆé¢„ç•™ï¼‰
- **çŠ¶æ€**: å¼€å‘ä¸­ï¼Œç•Œé¢å·²é¢„ç•™
- **åŠŸèƒ½**: Active Directoryé›†æˆç™»å½•
- **è®¡åˆ’**: åç»­ç‰ˆæœ¬å®ç°

## ğŸ¨ ç•Œé¢è®¾è®¡

### å¸ƒå±€ç»“æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·¦ä¾§å“ç‰Œå±•ç¤ºåŒºåŸŸï¼ˆ2/3ï¼‰    â”‚  å³ä¾§ç™»å½•åŒºåŸŸï¼ˆ1/3ï¼‰      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GoQGo Logo          â”‚    â”‚  â”‚ ç™»å½•è¡¨å•            â”‚  â”‚
â”‚  â”‚ å“ç‰Œæ ‡é¢˜            â”‚    â”‚  â”‚ - Tokenç™»å½•         â”‚  â”‚
â”‚  â”‚ åŠŸèƒ½ç‰¹æ€§ä»‹ç»        â”‚    â”‚  â”‚ - ADç™»å½•(é¢„ç•™)      â”‚  â”‚
â”‚  â”‚ ç‰ˆæœ¬ä¿¡æ¯            â”‚    â”‚  â”‚ å¸®åŠ©è¯´æ˜            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸»é¢˜é€‚é…
- **æ·±è‰²æ¨¡å¼**: è‡ªåŠ¨é€‚é…ç³»ç»Ÿä¸»é¢˜
- **å“åº”å¼è®¾è®¡**: æ”¯æŒç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- **ç°ä»£åŒ–UI**: ä½¿ç”¨Naive UIç»„ä»¶åº“

## ğŸ”§ æŠ€æœ¯å®ç°

### è·¯ç”±å®ˆå«
```typescript
// è·¯ç”±ä¿æŠ¤é€»è¾‘
router.beforeEach((to, from, next) => {
  const userStore = useUserStore()
  const requiresAuth = to.meta.requiresAuth !== false
  const hideForAuth = to.meta.hideForAuth === true
  
  if (requiresAuth && !userStore.isAuthenticated) {
    next('/login') // è·³è½¬åˆ°ç™»å½•é¡µ
  } else if (hideForAuth && userStore.isAuthenticated) {
    next('/') // å·²ç™»å½•ç”¨æˆ·è·³è½¬åˆ°é¦–é¡µ
  } else {
    next() // å…è®¸è®¿é—®
  }
})
```

### ç”¨æˆ·Store
```typescript
// ä¸»è¦åŠŸèƒ½
- loginWithToken(token: string) // Tokenç™»å½•
- loginWithAD(username, password) // ADç™»å½•ï¼ˆé¢„ç•™ï¼‰
- logout() // ç™»å‡º
- restoreAuth() // æ¢å¤ç™»å½•çŠ¶æ€
- fetchCurrentUser() // è·å–ç”¨æˆ·ä¿¡æ¯
```

### çŠ¶æ€ç®¡ç†
```typescript
interface User {
  id: string
  username: string
  displayName?: string
  email?: string
  avatar?: string
  role?: string
  permissions?: string[]
}
```

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

### TokenéªŒè¯
- **æ ¼å¼æ£€æŸ¥**: æœ€å°é•¿åº¦10å­—ç¬¦
- **å‰ç¼€éªŒè¯**: æ”¯æŒ`goqgo_`å‰ç¼€token
- **è¿‡æœŸæ£€æŸ¥**: 24å°æ—¶è‡ªåŠ¨è¿‡æœŸ
- **æœ¬åœ°å­˜å‚¨**: å®‰å…¨çš„localStorageå­˜å‚¨

### æƒé™æ§åˆ¶
- **é¡µé¢çº§æƒé™**: è·¯ç”±å®ˆå«ä¿æŠ¤
- **åŠŸèƒ½çº§æƒé™**: åŸºäºç”¨æˆ·è§’è‰²å’Œæƒé™
- **APIçº§æƒé™**: åå°tokenè§£æç”¨æˆ·èº«ä»½

## ğŸ“‹ ä½¿ç”¨æµç¨‹

### ç”¨æˆ·ç™»å½•æµç¨‹
1. è®¿é—®ä»»æ„éœ€è¦è®¤è¯çš„é¡µé¢
2. è‡ªåŠ¨è·³è½¬åˆ° `/login` é¡µé¢
3. é€‰æ‹©Tokenç™»å½•æ–¹å¼
4. è¾“å…¥è®¿é—®ä»¤ç‰Œ
5. ç‚¹å‡»ç™»å½•æŒ‰é’®
6. éªŒè¯æˆåŠŸåè·³è½¬åˆ°é¦–é¡µ

### è·å–Token
- è”ç³»ç³»ç»Ÿç®¡ç†å‘˜è·å–ä¸ªäººè®¿é—®ä»¤ç‰Œ
- ä»¤ç‰Œç”¨äºèº«ä»½éªŒè¯å’Œèµ„æºè®¿é—®æ§åˆ¶
- è¯·å¦¥å–„ä¿ç®¡ä»¤ç‰Œï¼Œä¸è¦ä¸ä»–äººåˆ†äº«

### ç™»å‡ºæµç¨‹
1. ç‚¹å‡»å³ä¸Šè§’ç”¨æˆ·å¤´åƒ
2. é€‰æ‹©"é€€å‡ºç™»å½•"
3. ç¡®è®¤é€€å‡º
4. æ¸…é™¤æœ¬åœ°è®¤è¯ä¿¡æ¯
5. è·³è½¬åˆ°ç™»å½•é¡µé¢

## ğŸ”„ çŠ¶æ€æ¢å¤

### è‡ªåŠ¨ç™»å½•
- é¡µé¢åˆ·æ–°æ—¶è‡ªåŠ¨æ¢å¤ç™»å½•çŠ¶æ€
- ä»localStorageè¯»å–ä¿å­˜çš„tokenå’Œç”¨æˆ·ä¿¡æ¯
- éªŒè¯tokenæœ‰æ•ˆæ€§
- å¤±è´¥æ—¶è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

### ä¼šè¯ç®¡ç†
- 24å°æ—¶tokenæœ‰æ•ˆæœŸ
- è‡ªåŠ¨è¿‡æœŸæ£€æŸ¥
- æ”¯æŒtokenåˆ·æ–°ï¼ˆé¢„ç•™ï¼‰

## ğŸ§ª æµ‹è¯•è¯´æ˜

### Tokenæ ¼å¼æµ‹è¯•
```javascript
// æœ‰æ•ˆtokenç¤ºä¾‹
"goqgo_abc123def456ghi789"
"1234567890abcdefghijklmnopqrstuvwxyz"

// æ— æ•ˆtokenç¤ºä¾‹
"123" // å¤ªçŸ­
"" // ç©ºå­—ç¬¦ä¸²
```

### ç™»å½•æµ‹è¯•ç”¨ä¾‹
1. **æ­£å¸¸ç™»å½•**: è¾“å…¥æœ‰æ•ˆtokenï¼ŒéªŒè¯ç™»å½•æˆåŠŸ
2. **æ— æ•ˆtoken**: è¾“å…¥æ— æ•ˆtokenï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
3. **ç©ºtoken**: ä¸è¾“å…¥tokenï¼Œæ˜¾ç¤ºéªŒè¯é”™è¯¯
4. **ç½‘ç»œé”™è¯¯**: æ¨¡æ‹Ÿç½‘ç»œå¼‚å¸¸ï¼Œæ˜¾ç¤ºé”™è¯¯å¤„ç†
5. **è‡ªåŠ¨è·³è½¬**: æœªç™»å½•è®¿é—®ä¿æŠ¤é¡µé¢ï¼Œè‡ªåŠ¨è·³è½¬ç™»å½•
6. **é‡å¤ç™»å½•**: å·²ç™»å½•ç”¨æˆ·è®¿é—®ç™»å½•é¡µï¼Œè·³è½¬é¦–é¡µ

## ğŸ“ ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒæ–‡ä»¶
- `src/views/LoginView.vue` - ç™»å½•é¡µé¢ç»„ä»¶
- `src/stores/user.ts` - ç”¨æˆ·çŠ¶æ€ç®¡ç†
- `src/router/index.ts` - è·¯ç”±é…ç½®å’Œå®ˆå«
- `src/components/UserInfo.vue` - ç”¨æˆ·ä¿¡æ¯ç»„ä»¶

### æ ·å¼æ–‡ä»¶
- ç™»å½•é¡µé¢æ ·å¼é›†æˆåœ¨ç»„ä»¶å†…
- æ”¯æŒæ·±è‰²æ¨¡å¼å’Œå“åº”å¼è®¾è®¡
- ä½¿ç”¨CSSå˜é‡é€‚é…ä¸»é¢˜

## ğŸš€ åç»­è®¡åˆ’

### çŸ­æœŸè®¡åˆ’
- [ ] é›†æˆçœŸå®çš„åå°API
- [ ] å®ç°tokenåˆ·æ–°æœºåˆ¶
- [ ] æ·»åŠ è®°ä½ç™»å½•çŠ¶æ€é€‰é¡¹
- [ ] ä¼˜åŒ–é”™è¯¯æç¤ºå’Œç”¨æˆ·ä½“éªŒ

### é•¿æœŸè®¡åˆ’
- [ ] å®ç°ADç™»å½•åŠŸèƒ½
- [ ] æ”¯æŒå¤šå› ç´ è®¤è¯
- [ ] æ·»åŠ ç™»å½•æ—¥å¿—å’Œå®‰å…¨å®¡è®¡
- [ ] å®ç°SSOå•ç‚¹ç™»å½•

## ğŸ”— APIæ¥å£

### ç™»å½•æ¥å£ï¼ˆå¾…å®ç°ï¼‰
```typescript
POST /api/v1/auth/login
{
  "token": "user_access_token"
}

Response:
{
  "user": {
    "id": "user_123",
    "username": "xops",
    "displayName": "å¼€å‘è€…",
    "email": "user@goqgo.com",
    "role": "developer",
    "permissions": ["chat:read", "chat:write"]
  },
  "token": "jwt_token_here",
  "expiresAt": "2025-08-02T02:30:00Z"
}
```

### ç”¨æˆ·ä¿¡æ¯æ¥å£ï¼ˆå¾…å®ç°ï¼‰
```typescript
GET /api/v1/users/me
Authorization: Bearer {token}

Response:
{
  "id": "user_123",
  "username": "xops",
  "displayName": "å¼€å‘è€…",
  "email": "user@goqgo.com",
  "role": "developer",
  "permissions": ["chat:read", "chat:write"],
  "lastLoginAt": "2025-08-01T02:30:00Z"
}
```

---

ç™»å½•ç³»ç»Ÿå·²å®ŒæˆåŸºç¡€å®ç°ï¼Œæ”¯æŒTokenè®¤è¯å’Œå®Œæ•´çš„ç”¨æˆ·ä¼šè¯ç®¡ç†ï¼ğŸ‰
